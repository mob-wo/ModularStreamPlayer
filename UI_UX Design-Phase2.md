## **UI/UX設計書: Modular Stream Player (Phase 2 - 差分)**

### 1. フェーズ2におけるUI/UXの主要変更点
本フェーズでは、ユーザーの操作性を大幅に向上させるため、以下の変更・機能追加を行います。

*   **ナビゲーションドロワーの導入**: トップバーの各種設定アイコンをドロワーに集約し、画面をシンプルにします。データソースの切り替えや表示設定など、アプリの主要な操作の起点となります。
*   **ファイルブラウザのリッチ化**: ファイルリストにID3タグから取得したアートワークや曲情報を表示し、視覚的に分かりやすくします。また、グリッド表示にも対応し、ユーザーが好みの表示密度を選べるようになります。
*   **2画面モードの導入**: ファイルブラウザとミニプレーヤーを同時に表示できるモードを追加し、曲を再生しながら次の曲を探す操作をスムーズにします。
*   **お気に入りパス管理**: よく使うフォルダに素早くアクセスできるよう、お気に入り登録・削除・一覧表示機能を追加します。

### 2. 更新された画面遷移図

フェーズ1のフローを基に、ドロワー、設定画面、お気に入り管理のフローを追加します。

```mermaid
graph TD
    subgraph "Main Flow"
        C[ファイルブラウザ画面] --> |[≡]アイコン| I(ナビゲーションドロワー)
        I --> |データソース切替| C
        I --> |お気に入りパス| C
        I --> |表示設定変更| C
        I --> |[⚙️]詳細設定| J[詳細設定画面]
        J --> |戻る| I

        C --> |フォルダを長押し| K[お気に入り追加処理]
        K -- 完了通知 --> C

        I --> |お気に入りパス長押し| L[削除確認ダイアログ]
        L -- 削除 --> I
    end

    subgraph "Playback Flow"
        C --> |曲アイテムをタップ| F[再生画面]
        F --> |戻る| C
    end
```

### 3. ワイヤーフレーム (追加・変更部)

#### 3.1. ファイルブラウザ画面 (BrowserScreen) - 更新

*   **トップバー**: ナビゲーションドロワーを開くためのアイコン `[≡]` のみとなり、よりクリーンな見た目になります。

**[ワイヤーフレーム: トップバー変更]**
```
+------------------------------------------------------+
| [≡] Modular Stream Player                          |
+------------------------------------------------------+
| ... (以降は変更なし)                                   |
```

*   **リストアイテム (`F-19`)**: ID3タグ情報を活用し、リッチな表示になります。

**[ワイヤーフレーム: リスト表示 (`大`)]**
```
|  [🖼️] Another Brick in the Wall                     |  <-- アートワーク + 曲名
|      Pink Floyd                                      |  <-- アーティスト名
|  --------------------------------------------------  |
```

*   **グリッド表示 (`F-20(改訂)`)**: ドロワーの設定により、表示形式を切り替え可能です。

**[ワイヤーフレーム: グリッド表示 (`中` / `小`)]**
```
// 中 (2列グリッド)
+------------------------+------------------------+
| +--------------------+ | +--------------------+ |
| |      アートワーク     | | |      アートワーク     | |
| +--------------------+ | +--------------------+ |
|   曲名１...            | |   曲名２...            | |
+------------------------+------------------------+

// 小 (3列グリッド)
+----------+----------+----------+
| [アート]  | [アート]  | [アート]  |
+----------+----------+----------+
```

*   **2画面モード (`F-21(改訂)`)**: ドロワーの設定により、画面下部にミニプレーヤーが表示されます。

**[ワイヤーフレーム: 2画面モード]**
```
+------------------------------------------------------+
| (ファイルブラウザ画面 ... )                            |
|                                                      |
|                                                      |
+------------------------------------------------------+
| +--------------------------------------------------+ |
| | [🖼️] 曲名...      [▶️] [⏭️]                       | |  <-- ミニプレーヤー
| +--------------------------------------------------+ |
+------------------------------------------------------+
```

#### 3.2. ナビゲーションドロワー (NavigationDrawer) - 新規

アプリの主要な操作を集約したパネルです。

**[ワイヤーフレーム]**
```
+----------------------------------+
| Modular Stream Player            |
| (アプリヘッダー)                 |
+----------------------------------+
| データソースの更新 [🔄]          |
+----------------------------------+
| ▼ データソース                   |
|   ◉ ローカルストレージ           |
|   ○ (NAS-Server: Phase3)         |
+----------------------------------+
| ▼ 表示設定                       |
|   画面モード                     |
|     (•) 1画面   ( ) 2画面        |  <-- トグルボタン
|   表示密度                       |
|     (•)リスト ( )中 ( )小       |  <-- トグルボタン
+----------------------------------+
| ▼ お気に入り (ローカル) [∨]      |  <-- クリックで展開/非表示
|   [⭐] Downloads                 |  (長押しで削除ダイアログ表示)
|   [⭐] Ripped_CDs                |
+----------------------------------+
|                                  |
| [⚙️] 詳細設定                    |
+----------------------------------+
```

#### 3.3. 詳細設定画面 (SettingsScreen) - 新規

変更頻度の低い項目を設定する画面です。ドロワーから遷移します。

**[ワイヤーフレーム]**
```
+------------------------------------------------------+
| [←] 詳細設定                                         |
+------------------------------------------------------+
|                                                      |
|  ローカルストレージ設定                              |
|  デフォルトパス                                      |
|    /storage/emulated/0/Music        [編集]           |
|  --------------------------------------------------  |
|  (Phase3以降のNAS設定項目)                           |
|                                                      |
+------------------------------------------------------+
```

### 4. 主要なユーザーインタラクション
*   **お気に入り追加 (`F-26`)**: ファイルブラウザでフォルダを長押しすると、「'フォルダ名'をお気に入りに追加しました」というメッセージ（Snackbar/Toast）が表示され、ドロワーに即時反映されます。
*   **お気に入り削除 (`F-27`)**: ドロワーでお気に入りパスを長押しすると、「'パス名'をお気に入りから削除しますか？」という確認ダイアログが表示されます。「削除」をタップするとリストから削除され、完了メッセージが表示されます。
